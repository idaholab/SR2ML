\section{Fault Tree Data Importer}
\label{sec:FTdataImporter}

The \textbf{FTImporter} post-processor has been designed to import Fault-Tree (FT) object into
RAVEN. Since several FT file formats are available, as of now only the OpenPSA format
(see https://open-psa.github.io/joomla1.5/index.php.html) is supported. As an example,
the FT in OpenPSA format is shown in Listing~\ref{lst:FTModel_2}.

\begin{lstlisting}[style=XML,morekeywords={anAttribute},caption=FT in OpenPSA format., label=lst:FTModel_2]
<opsa-mef>
    <define-fault-tree name="FT">
        <define-gate name="TOP">
            <or>
                <gate name="G1"/>
                <gate name="G2"/>
                <gate name="G3"/>
            </or>
        </define-gate>
        <define-component name="A">
            <define-gate name="G1">
                <and>
                    <basic-event name="BE1"/>
                    <basic-event name="BE2"/>
                </and>
            </define-gate>
            <define-gate name="G2">
                <and>
                    <basic-event name="BE1"/>
                    <basic-event name="BE3"/>
                </and>
            </define-gate>
            <define-basic-event name="BE1">
                <float value="1.2e-3"/>
            </define-basic-event>
            <define-component name="B">
                <define-basic-event name="BE2">
                    <float value="2.4e-3"/>
                </define-basic-event>
                <define-basic-event name="BE3">
                    <float value="5.2e-3"/>
                </define-basic-event>
            </define-component>
        </define-component>
        <define-component name="C">
            <define-gate name="G3">
                <and>
                    <basic-event name="BE1"/>
                    <basic-event name="BE4"/>
                </and>
            </define-gate>
            <define-basic-event name="BE4">
                <float value="1.6e-3"/>
            </define-basic-event>
        </define-component>
    </define-fault-tree>
</opsa-mef>
\end{lstlisting}

This is performed by saving the structure of the FT (from file) as a \textbf{PointSet}
(only \textbf{PointSet} are allowed).

Each Point in the PointSet represents a unique combination of the basic events.
The PointSet is structured as follows: input variables are the basic events, output variable is the top event of the FT.
The value for each input and output variable can have the following values:
\begin{itemize}
  \item  0: False
  \item  1: True
\end{itemize}

Provided this definition, the FT model of Listing~\ref{lst:FTModel_2} can be converted to
\textbf{PointSet} that is characterized by these variables:
\begin{itemize}
	\item Input variables: BE1, BE2, BE3, BE4
	\item Output variable: out
\end{itemize}
and it is structured is shown in Table~\ref{PointSetFT}.

\begin{table}[h]
    \centering
    \caption{PointSet generated by RAVEN by employing the FT Importer Post-Processor for the FT of Listing~\ref{lst:FTModel_2}.}
    \label{PointSetFT}
	\begin{tabular}{c | c | c | c | c}
		\hline
		BE1 & BE2 & BE3 & BE4 & TOP \\
		\hline
		 0. &  0. &  0. &  0. &  0. \\
		 0. &  0. &  0. &  1. &  0. \\
		 0. &  0. &  1. &  0. &  0. \\
		 0. &  0. &  1. &  1. &  0. \\
		 0. &  1. &  0. &  0. &  0. \\
		 0. &  1. &  0. &  1. &  0. \\
		 0. &  1. &  1. &  0. &  0. \\
		 0. &  1. &  1. &  1. &  0. \\
		 1. &  0. &  0. &  0. &  0. \\
		 1. &  0. &  0. &  1. &  1. \\
		 1. &  0. &  1. &  0. &  1. \\
		 1. &  0. &  1. &  1. &  1. \\
		 1. &  1. &  0. &  0. &  1. \\
		 1. &  1. &  0. &  1. &  1. \\
		 1. &  1. &  1. &  0. &  1. \\
		 1. &  1. &  1. &  1. &  1. \\
		\hline
	\end{tabular}
\end{table}

%
\ppType{FTImporter}{FTImporter}
%
\begin{itemize}
  \item \xmlNode{fileFormat}, \xmlDesc{string, required field}, specifies the format of the file that contains the
    FT structure (supported format: OpenPSA).
  \item  \xmlNode{topEventID},\xmlDesc{string, required parameter}, the name of the top event of the FT
\end{itemize}

The example of FTImporter PostProcessor is shown in Listing~\ref{lst:FT_PP_InputExample}
\begin{lstlisting}[style=XML,morekeywords={anAttribute},caption=FT Importer input example., label=lst:FT_PP_InputExample]
  <Files>
    <Input name="faultTreeTest" type="">FTimporter_not.xml</Input>
  </Files>

  <Models>
    ...
    <PostProcessor name="FTimporter" subType="SR2ML.FTImporter">
      <fileFormat>OpenPSA</fileFormat>
      <topEventID>TOP</topEventID>
    </PostProcessor>
    ...
  </Models>

  <Steps>
    ...
    <PostProcess name="import">
      <Input   class="Files"        type=""                >faultTreeTest</Input>
      <Model   class="Models"       type="PostProcessor"   >FTimporter</Model>
      <Output  class="DataObjects"  type="PointSet"        >FT_PS</Output>
    </PostProcess>
    ...
  </Steps>

  <DataObjects>
    ...
    <PointSet name="FT_PS">
      <Input>BE1,BE2,BE3,BE4</Input>
      <Output>TOP</Output>
    </PointSet>
    ...
  </DataObjects>
\end{lstlisting}

Important notes and capabilities:
\begin{itemize}
	\item If the FT is split in two or more FTs (and thus one file for each FT), then it is only required to list
	      all files in the Step. RAVEN automatically detect links among FTs and merge all of them into a single PointSet.
	\item Allowed gates: AND, OR, NOT, ATLEAST, CARDINALITY, IFF, imply, NAND, NOR, XOR
	\item If an house-event is defined in the FT:
\begin{lstlisting}[style=XML,morekeywords={anAttribute},caption=FT Importer input example: house-event., label=lst:FT_house event]
<opsa-mef>
    <define-fault-tree name="FT">
        <define-gate name="TOP">
            <or>
                <basic-event name="BE1"/>
                <basic-event name="BE2"/>
                <house-event name="HE1"/>
            </or>
        </define-gate>
        <define-house-event name="HE1">
        	<constant value="true"/>
        </define-house-event>
    </define-fault-tree>
</opsa-mef>
\end{lstlisting}
           then the HE1 is not part of the PointSet (value is fixed)
\end{itemize}

\subsection{FT Importer Reference Tests}
\begin{itemize}
	\item test\_FTimporter\_and\_withNOT\_embedded.xml
	\item test\_FTimporter\_and\_withNOT\_withNOT\_embedded.xml
	\item test\_FTimporter\_and\_withNOT.xml
	\item test\_FTimporter\_and.xml
	\item test\_FTimporter\_atleast.xml
	\item test\_FTimporter\_cardinality.xml
	\item test\_FTimporter\_component.xml
	\item test\_FTimporter\_doubleNot.xml
	\item test\_FTimporter\_iff.xml
	\item test\_FTimporter\_imply.xml
	\item test\_FTimporter\_multipleFTs.xml
	\item test\_FTimporter\_nand.xml
	\item test\_FTimporter\_nor.xml
	\item test\_FTimporter\_not.xml
	\item test\_FTimporter\_or\_houseEvent.xml
	\item test\_FTimporter\_or.xml
	\item test\_FTimporter\_xor.xml.
\end{itemize}
